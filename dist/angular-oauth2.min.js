function oauthConfig(e){e.interceptors.push("oauthInterceptor")}function oauthInterceptor(e,t,n){return{request:function(e){return e.headers=e.headers||{},!e.headers.hasOwnProperty("Authorization")&&n.getAuthorizationHeader()&&(e.headers.Authorization=n.getAuthorizationHeader()),e},responseError:function(r){return r?(400!==r.status||!r.data||"invalid_request"!==r.data.error&&"invalid_grant"!==r.data.error||(n.removeToken(),t.$emit("oauth:error",r)),(401===r.status&&r.data&&"invalid_token"===r.data.error||r.headers&&r.headers("www-authenticate")&&0===r.headers("www-authenticate").indexOf("Bearer"))&&t.$emit("oauth:error",r),e.reject(r)):e.reject(r)}}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OAuthProvider(){var e=this,t=function(e){return e?Object.keys(e).map(function(t){var n=e[t];return Array.isArray(n)?n.map(function(e){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&"):encodeURIComponent(t)+"="+encodeURIComponent(n)}).join("&"):""},n=function(e){if(!(e instanceof Object))throw new TypeError("Invalid argument: `config` must be an `Object`.");var t=angular.extend({},defaults,e);return angular.forEach(requiredKeys,function(e){if(!t[e])throw new Error("Missing parameter: "+e+".")}),"/"===t.baseUrl.substr(-1)&&(t.baseUrl=t.baseUrl.slice(0,-1)),"/"!==t.grantPath[0]&&(t.grantPath="/"+t.grantPath),"/"!==t.revokePath[0]&&(t.revokePath="/"+t.revokePath),t};this.configure=function(t){e.defaultConfig=n(t)},this.$get=function(e,r){var o=function(){function o(e){_classCallCheck(this,o),this.config=e}return _createClass(o,[{key:"configure",value:function(e){this.config=n(e)}},{key:"isAuthenticated",value:function(){return!!r.getToken()}},{key:"getAccessToken",value:function(n,o){return n=angular.extend({client_id:this.config.clientId,grant_type:"password"},n),null!==this.config.clientSecret&&(n.client_secret=this.config.clientSecret),n=t(n),o=angular.extend({headers:{Authorization:void 0,"Content-Type":"application/x-www-form-urlencoded"}},o),e.post(""+this.config.baseUrl+this.config.grantPath,n,o).then(function(e){return r.setToken(e.data),e})}},{key:"getRefreshToken",value:function(n,o){return n=angular.extend({client_id:this.config.clientId,grant_type:"refresh_token",refresh_token:r.getRefreshToken()},n),null!==this.config.clientSecret&&(n.client_secret=this.config.clientSecret),n=t(n),o=angular.extend({headers:{Authorization:void 0,"Content-Type":"application/x-www-form-urlencoded"}},o),e.post(""+this.config.baseUrl+this.config.grantPath,n,o).then(function(e){return r.setToken(e.data),e})}},{key:"revokeToken",value:function(n,o){var a=r.getRefreshToken();return n=angular.extend({client_id:this.config.clientId,token:a?a:r.getAccessToken(),token_type_hint:a?"refresh_token":"access_token"},n),null!==this.config.clientSecret&&(n.client_secret=this.config.clientSecret),n=t(n),o=angular.extend({headers:{"Content-Type":"application/x-www-form-urlencoded"}},o),e.post(""+this.config.baseUrl+this.config.revokePath,n,o).then(function(e){return r.removeToken(),e})}}]),o}();return new o(this.defaultConfig)},this.$get.$inject=["$http","OAuthToken"]}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OAuthTokenProvider(){var e={name:"token",options:{secure:!0}};this.configure=function(t){if(!(t instanceof Object))throw new TypeError("Invalid argument: `config` must be an `Object`.");return angular.extend(e,t),e},this.$get=function(t){var n=function(){function n(){_classCallCheck(this,n)}return _createClass(n,[{key:"setToken",value:function(n){return t.putObject(e.name,n,e.options)}},{key:"getToken",value:function(){return t.getObject(e.name)}},{key:"getAccessToken",value:function(){var e=this.getToken()||{},t=e.access_token;return t}},{key:"getAuthorizationHeader",value:function(){var e=this.getTokenType(),t=this.getAccessToken();if(e&&t)return e.charAt(0).toUpperCase()+e.substr(1)+" "+t}},{key:"getRefreshToken",value:function(){var e=this.getToken()||{},t=e.refresh_token;return t}},{key:"getTokenType",value:function(){var e=this.getToken()||{},t=e.token_type;return t}},{key:"removeToken",value:function(){return t.remove(e.name,e.options)}}]),n}();return new n},this.$get.$inject=["$cookies"]}angular.module("angular-oauth2",["ngCookies"]).config(oauthConfig).factory("oauthInterceptor",oauthInterceptor).provider("OAuth",OAuthProvider).provider("OAuthToken",OAuthTokenProvider),oauthConfig.$inject=["$httpProvider"],oauthInterceptor.$inject=["$q","$rootScope","OAuthToken"];var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),defaults={baseUrl:null,clientId:null,clientSecret:null,grantPath:"/oauth2/token",revokePath:"/oauth2/revoke"},requiredKeys=["baseUrl","clientId","grantPath","revokePath"],_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();